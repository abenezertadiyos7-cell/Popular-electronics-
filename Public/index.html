<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shopink</title>
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <!-- htmx -->
  <script src="https://unpkg.com/htmx.org@1.9.6"></script>
  <!-- Stimulus -->
  <script type="module">
    import { Application } from 'https://unpkg.com/@hotwired/stimulus?module'
    window.Stimulus = Application.start()
  </script>
  <style>
    body {
      font-family: Inter, system-ui, sans-serif;
      background-color: #ffffff;
      color: #1f2937;
    }
    .filter-btn.active {
      @apply bg-black text-white;
    }
    .filter-btn {
      @apply text-black bg-gray-100;
    }
  </style>
</head>
<body class="bg-white max-w-sm mx-auto pb-16">

  <!-- Alpine Store for Favorites -->
  <div x-data="shopinkApp()" x-init="loadFavorites()">

    <!-- HEADER -->
    <header class="flex justify-between items-center p-4 bg-white border-b border-gray-200">
      <button @click="toggleMenu" class="text-xl">‚ò∞</button>
      <h1 class="font-bold text-lg">Shopink</h1>
      <div class="relative">
        <button @click="toggleNotifications" class="text-xl">üîî</button>
        <span x-show="notificationCount > 0" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">2</span>
      </div>
    </header>

    <!-- HERO BANNER -->
    <div class="relative bg-cover bg-center h-40 mb-6 overflow-hidden">
      <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?auto=format&fit=crop&w=375&q=80" alt="Sale Banner" class="w-full h-full object-cover">
      <div class="absolute inset-0 bg-black bg-opacity-40 flex flex-col items-center justify-center text-white text-center p-4">
        <h2 class="text-lg font-bold mb-2">Get your special sale up to 50%</h2>
        <button 
          hx-get="/shop-now" 
          hx-target="#main-content"
          class="bg-yellow-400 text-black px-4 py-2 rounded-full font-bold text-sm">
          Shop now
        </button>
      </div>
    </div>

    <!-- NEW ARRIVALS -->
    <section class="px-4 mb-6" id="new-arrivals">
      <div class="flex justify-between items-center mb-3">
        <h2 class="font-bold text-lg">New Arrival</h2>
        <a href="#" class="text-sm text-gray-600">See all</a>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <template x-for="product in newArrivals" :key="product.id">
          <div 
            @click="viewProduct(product)"
            class="bg-white rounded-lg overflow-hidden shadow-sm border cursor-pointer"
            :class="{'border-red-200': product.favorite}">
            <img :src="product.image" :alt="product.name" class="w-full h-32 object-cover">
            <div class="p-3">
              <h3 class="text-sm font-medium" x-text="product.name"></h3>
              <p class="text-xs text-gray-500" x-text="product.category"></p>
              <p class="font-bold mt-1" x-text="product.price"></p>
              <button 
                @click.stop="toggleFavorite(product.id)"
                class="text-red-500 mt-2 text-lg"
                :class="{'text-red-600 fill-current': product.favorite}">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" x-show="!product.favorite">
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" x-show="product.favorite" x-cloak>
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
              </button>
            </div>
          </div>
        </template>
      </div>
    </section>

    <!-- BEST SELLERS WITH FILTERS -->
    <section class="px-4 mb-6" id="best-sellers">
      <h2 class="font-bold text-lg mb-3">Best Seller</h2>
      <div class="flex space-x-2 mb-4 overflow-x-auto pb-2 hide-scrollbar">
        <template x-for="(filter, index) in filters" :key="index">
          <button 
            @click="setActiveFilter(filter.label)"
            class="filter-btn text-xs font-medium px-3 py-1.5 rounded-full whitespace-nowrap"
            :class="{'active': activeFilter === filter.label}">
            <span x-text="filter.label"></span>
          </button>
        </template>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <template x-for="product in filteredBestSellers" :key="product.id">
          <div 
            @click="viewProduct(product)"
            class="bg-white rounded-lg overflow-hidden shadow-sm border cursor-pointer"
            :class="{'border-red-200': product.favorite}">
            <div class="relative">
              <img :src="product.image" :alt="product.name" class="w-full h-32 object-cover">
              <span x-show="product.discount" class="absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full" x-text="product.discount"></span>
            </div>
            <div class="p-3">
              <h3 class="text-sm font-medium" x-text="product.name"></h3>
              <p class="text-xs text-gray-500" x-text="product.category"></p>
              <p class="font-bold mt-1" x-text="product.price"></p>
              <button 
                @click.stop="toggleFavorite(product.id)"
                class="text-red-500 mt-2 text-lg"
                :class="{'text-red-600 fill-current': product.favorite}">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" x-show="!product.favorite">
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" x-show="product.favorite" x-cloak>
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
              </button>
            </div>
          </div>
        </template>
      </div>
    </section>

    <!-- FOOTER NAV -->
    <footer class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-around py-2 px-4">
      <button 
        @click="setActiveTab('home')"
        class="flex flex-col items-center text-xs"
        :class="activeTab === 'home' ? 'text-black' : 'text-gray-500'">
        <span>üè†</span>
        <span>Home</span>
      </button>
      <button 
        @click="setActiveTab('cart')"
        class="flex flex-col items-center text-xs"
        :class="activeTab === 'cart' ? 'text-black' : 'text-gray-500'">
        <span>üõí</span>
        <span>Cart</span>
      </button>
      <button 
        @click="setActiveTab('wishlist')"
        class="flex flex-col items-center text-xs"
        :class="activeTab === 'wishlist' ? 'text-black' : 'text-gray-500'">
        <span>‚ù§Ô∏è</span>
        <span>Wishlist</span>
      </button>
      <button 
        @click="setActiveTab('profile')"
        class="flex flex-col items-center text-xs"
        :class="activeTab === 'profile' ? 'text-black' : 'text-gray-500'">
        <span>üë§</span>
        <span>Profile</span>
      </button>
    </footer>

  </div>

  <!-- Vanilla JS Helpers -->
  <script>
    // Simple Helpers
    const helpers = {
      debounce: (func, delay) => {
        let timeoutId;
        return (...args) => {
          clearTimeout(timeoutId);
          timeoutId = setTimeout(() => func.apply(this, args), delay);
        };
      },
      formatCurrency: (amount) => {
        return new Intl.NumberFormat('en-US', {
          style: 'currency',
          currency: 'USD'
        }).format(amount);
      },
      scrollToTop: () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      },
      showToast: (message) => {
        let toast = document.createElement('div');
        toast.innerText = message;
        toast.className = 'fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-black text-white px-4 py-2 rounded-lg z-50';
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }
    };

    // Alpine.js Component
    function shopinkApp() {
      return {
        notificationCount: 2,
        activeTab: 'home',
        activeFilter: 'All',

        // Data
        newArrivals: [
          {
            id: 1,
            image: "https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?auto=format&fit=crop&w=300&q=80",
            name: "Nike Blazer Low '77 Jumbo",
            category: "Women's Shoes",
            price: "$120.11",
            favorite: false
          },
          {
            id: 2,
            image: "https://images.unsplash.com/photo-1549298916-b41d501d3772?auto=format&fit=crop&w=300&q=80",
            name: "Nike Air Force 1 '07 LVB Next Nature",
            category: "Men's Shoes",
            price: "$230.11",
            favorite: true
          }
        ],

        bestSellers: [
          {
            id: 3,
            image: "https://images.unsplash.com/photo-1608231387042-66d1773070a5?auto=format&fit=crop&w=300&q=80",
            name: "Nike Air Max 90",
            category: "Men's Shoes",
            price: "$180.00",
            discount: "10% off",
            favorite: false,
            brand: "Nike"
          },
          {
            id: 4,
            image: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?auto=format&fit=crop&w=300&q=80",
            name: "Adidas Ultraboost",
            category: "Running Shoes",
            price: "$190.00",
            discount: "15% off",
            favorite: false,
            brand: "Adidas"
          }
        ],

        filters: [
          { label: "All", active: true },
          { label: "Nike" },
          { label: "Adidas" },
          { label: "New Balance" },
          { label: "Puma" }
        ],

        // Computed
        get filteredBestSellers() {
          if (this.activeFilter === 'All') return this.bestSellers;
          return this.bestSellers.filter(p => p.brand === this.activeFilter);
        },

        // Methods
        toggleMenu() {
          helpers.showToast("Menu opened");
        },
        toggleNotifications() {
          helpers.showToast("Notifications opened");
        },
        setActiveTab(tab) {
          this.activeTab = tab;
          helpers.showToast(`Switched to ${tab}`);
        },
        setActiveFilter(filter) {
          this.activeFilter = filter;
        },
        toggleFavorite(id) {
          const toggleIn = (list) => {
            const item = list.find(p => p.id === id);
            if (item) item.favorite = !item.favorite;
          };
          toggleIn(this.newArrivals);
          toggleIn(this.bestSellers);
          this.saveFavorites();
          helpers.showToast(item.favorite ? "Added to favorites ‚ù§Ô∏è" : "Removed from favorites");
        },
        viewProduct(product) {
          // htmx-style navigation simulation
          console.log("Viewing product:", product.name);
          helpers.showToast(`Viewing ${product.name}`);
        },
        saveFavorites() {
          const allProducts = [...this.newArrivals, ...this.bestSellers];
          const favorites = allProducts.filter(p => p.favorite).map(p => p.id);
          localStorage.setItem('shopink_favorites', JSON.stringify(favorites));
        },
        loadFavorites() {
          const saved = JSON.parse(localStorage.getItem('shopink_favorites') || '[]');
          const restore = (list) => {
            list.forEach(p => p.favorite = saved.includes(p.id));
          };
          restore(this.newArrivals);
          restore(this.bestSellers);
        }
      };
    }

    // Stimulus Controllers (simulated)
    document.addEventListener('DOMContentLoaded', () => {
      // Favorites Controller
      Stimulus.register('favorites', class extends Stimulus.Controller {
        static targets = [ "icon" ]
        toggle(event) {
          const id = event.params.id;
          const app = document.querySelector('[x-data]').__x;
          app.toggleFavorite(id);
        }
      });

      // Filter Controller
      Stimulus.register('filter', class extends Stimulus.Controller {
        change(event) {
          const label = event.target.textContent.trim();
          const app = document.querySelector('[x-data]').__x;
          app.setActiveFilter(label);
        }
      });

      // Cart Controller
      Stimulus.register('cart', class extends Stimulus.Controller {
        addToCart(event) {
          const id = event.params.id;
          helpers.showToast(`Item ${id} added to cart üõí`);
          // htmx call
          // fetch('/api/cart/add', { method: 'POST', body: JSON.stringify({ id }) })
        }
      });
    });

    // Hide scrollbar for filter bar
    const style = document.createElement('style');
    style.textContent = `
      .hide-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
  </html>
